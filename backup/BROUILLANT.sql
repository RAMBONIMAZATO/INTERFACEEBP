
                                                            	/*switch($row["Deptid"]) {
                                                                    case 23:
                                                                        echo "QA";
                                                                        break;
                                                            		case 30:
                                                            			echo "ADM";
                                                            			break;
                                                            		case 31:
                                                            			echo "BDR";
                                                            			break;
                                                            		case 32:
                                                            			echo "CPE";
                                                            			break;
                                                            		case 33:
                                                            			echo "CPL";
                                                            			break;
                                                            		case 34:
                                                            			echo "GNR";
                                                            			break;
                                                            		case 35:
                                                            			echo "EXP";
                                                            			break;
                                                            		case 36:
                                                            			echo "LN1";
                                                            			break;
                                                            		case 37:
                                                            			echo "LVG";
                                                            			break;
                                                            		case 38:
                                                            			echo "MNT";
                                                            			break;
                                                            		case 39:
                                                            			echo "MEC";
                                                            			break;
                                                            		case 40:
                                                            			echo "MRO";
                                                            			break;
                                                            		case 41:
                                                            			echo "SMP";
                                                            			break;
                                                            		case 42:
                                                            			echo "STR";
                                                            			break;
                                                            		case 44:
                                                            			echo "DPR";
                                                            			break;
                                                            		case 45:
                                                            			echo "FNT";
                                                            			break;
                                                            		case 46:
                                                            			echo "LN2";
                                                            			break;
                                                            		case 47:
                                                            			echo "LN3";
                                                            			break;
                                                            		case 48:
                                                            			echo "LN4";
                                                            			break;
                                                            		case 49:
                                                            			echo "LN5";
                                                            			break;
                                                            		case 50:
                                                            			echo "LN6";
                                                            			break;
                                                            		case 51:
                                                            			echo "LN7";
                                                            			break;
                                                            		case 52:
                                                            			echo "ZPR";
                                                            			break;
                                                            		case 53:
                                                            			echo "LN8";
                                                            			break;
                                                            		case 54:
                                                            			echo "LN9";
                                                            			break;
                                                            		case 55:
                                                            			echo "LN10";
                                                            			break;
                                                            		case 56:
                                                            			echo "LN11";
                                                            			break;
                                                            		case 57:
                                                            			echo "LN12";
                                                            			break;
                                                            		case 58:
                                                            			echo "IE";
                                                            			break;
                                                            		case 59:
                                                            			echo "LN13";
                                                            			break;
                                                            		case 60:
                                                            			echo "LN14";
                                                            			break;
                                                            		case 61:
                                                            			echo "RCL";
                                                            			break;
                                                            		case 62:
                                                            			echo "LN15";
                                                            			break;
                                                            		case 63:
                                                            			echo "RH";
                                                            			break;
                                                            		case 64:
                                                            			echo "RESP";
                                                            			break;
                                                            		case 65:
                                                            			echo "STC";
                                                            			break;
                                                            		case 66:
                                                            			echo "TRAIN";
                                                            			break;
                                                            		case 67:
                                                            			echo "LN16";
                                                            			break;
                                                            		case 68:
                                                            			echo "GNBR";
                                                            			break;
                                                            		case 69:
                                                            			echo "LN17";
                                                            			break;
                                                            		case 70:
                                                            			echo "BDRJ";
                                                            			break;
                                                            		case 71:
                                                            			echo "CPEJ";
                                                            			break;
                                                            		case 72:
                                                            			echo "CPLJ";
                                                            			break;
                                                            		case 73:
                                                            			echo "LVGJ";
                                                            			break;
                                                            		case 74:
                                                            			echo "MNTJ";
                                                            			break;
                                                            		case 75:
                                                            			echo "MECJ";
                                                            			break;
                                                            		case 76:
                                                            			echo "MROJ";
                                                            			break;
                                                            		case 77:
                                                            			echo "SMPJ";
                                                            			break;
                                                            		case 78:
                                                            			echo "STRJ";
                                                            			break;
                                                            		case 79:
                                                            			echo "DPRJ";
                                                            			break;
                                                            		case 80:
                                                            			echo "FNTJ";
                                                            			break;
                                                            		case 81:
                                                            			echo "GNRJ";
                                                            			break;
                                                            		case 82:
                                                            			echo "ADMJ";
                                                            			break;
                                                            		case 83:
                                                            			echo "DPRCDD";
                                                            			break;
                                                            		case 84:
                                                            			echo "LVGCDD";
                                                            			break;
                                                            		case 85:
                                                            			echo "BDRCDD";
                                                            			break;
                                                            		case 86:
                                                            			echo "GNRS";
                                                            			break;
                                                            		case 87:
                                                            			echo "FORMATION";
                                                            			break;
                                                            		case 88:
                                                            			echo "CPLC";
                                                            			break;
                                                            		case 89:
                                                            			echo "BDRPS";
                                                            			break;
                                                            		case 90:
                                                            			echo "CPEF";
                                                            			break;
                                                            		case 100:
                                                            			echo "FNTLO";
                                                            			break;
                                                            		case 101:
                                                            			echo "MNTWT";
                                                            			break;
                                                                    case 102:
                                                                        echo "FNTCDD";
                                                                        break;
                                                                    };

                                   <!--  <option value="23">QA</option>
                                    <option value="30">ADM</option>
                                    <option value="31">BDR</option>
                                    <option value="32">CPE</option>
                                    <option value="33">CPL</option>
                                    <option value="34">GNR</option>
                                    <option value="35">EXP</option>
                                    <option value="36">LN1</option>
                                    <option value="37">LVG</option>
                                    <option value="38">MNT</option>
                                    <option value="39">MEC</option>
                                    <option value="40">MRO</option>
                                    <option value="41">SMP</option>
                                    <option value="42">STR</option>
                                    <option value="44">DPR</option>
                                    <option value="45">FNT</option>
                                    <option value="46">LN2</option>
                                    <option value="47">LN3</option>
                                    <option value="48">LN4</option>
                                    <option value="49">LN5</option>
                                    <option value="50">LN6</option>
                                    <option value="51">LN7</option>
                                    <option value="52">ZPR</option>
                                    <option value="53">LN8</option>
                                    <option value="54">LN9</option>
                                    <option value="55">LN10</option>
                                    <option value="56">LN11</option>
                                    <option value="57">LN12</option>
                                    <option value="58">IE</option>
                                    <option value="59">LN13</option>
                                    <option value="60">LN14</option>
                                    <option value="61">RCL</option>
                                    <option value="62">LN15</option>
                                    <option value="63">RH</option>
                                    <option value="64">RESP</option>
                                    <option value="65">STC</option>
                                    <option value="66">TRAIN</option>
                                    <option value="67">LN16</option>
                                    <option value="68">GNBR</option>
                                    <option value="69">LN17</option>
                                    <option value="70">BDRJ</option>
                                    <option value="71">CPEJ</option>
                                    <option value="72">CPLJ</option>
                                    <option value="73">LVGJ</option>
                                    <option value="74">MNTJ</option>
                                    <option value="75">MECJ</option>
                                    <option value="76">MROJ</option>
                                    <option value="77">SMPJ</option>
                                    <option value="78">STRJ</option>
                                    <option value="79">DPRJ</option>
                                    <option value="80">FNTJ</option>
                                    <option value="81">GNRJ</option>
                                    <option value="82">ADMJ</option>
                                    <option value="83">DPRCDD</option>
                                    <option value="84">LVGCDD</option>
                                    <option value="85">BDRCDD</option>
                                    <option value="86">GNRS</option>
                                    <option value="87">FORMATION</option>
                                    <option value="88">CPLC</option>
                                    <option value="89">BDRPS</option>
                                    <option value="90">CPEF</option>
                                    <option value="100">FNTLO</option>
                                    <option value="101">MNTWT</option>
                                    <option value="102">FNTCDD</option> -->*/
                                    
                                            /*if (isset($_POST['show_btn'])) {
                                            	$Deptid = $_POST['show_id'];
                                                $Dates = $_POST['show_id2'];*/
	                                            /*
<!--                                                                        <option value="QA">QA</option><option value="ADM">ADM</option><option value="BDR">BDR</option><option value="CPE">CPE</option><option value="CPL">CPL</option><option value="GNR">GNR</option><option value="EXP">EXP</option><option value="LN1">LN1</option><option value="LVG">LVG</option><option value="MNT">MNT</option><option value="MEC">MEC</option><option value="MRO">MRO</option><option value="SMP">SMP</option><option value="STR">STR</option><option value="DPR">DPR</option><option value="FNT">FNT</option><option value="LN2">LN2</option><option value="LN3">LN3</option><option value="LN4">LN4</option><option value="LN5">LN5</option><option value="LN6">LN6</option><option value="LN7">LN7</option><option value="ZPR">ZPR</option><option value="LN8">LN8</option><option value="LN9">LN9</option><option value="LN10">LN10</option><option value="LN11">LN11</option><option value="LN12">LN12</option><option value="IE">IE</option><option value="LN13">LN13</option><option value="LN14">LN14</option><option value="61">RCL</option><option value="62">LN15</option><option value="63">RH</option><option value="64">RESP</option><option value="STC">STC</option><option value="TRAIN">TRAIN</option><option value="LN6">LN6</option><option value="GNBR">GNBR</option><option value="LN17">LN17</option><option value="BDRJ">BDRJ</option><option value="CPEJ">CPEJ</option><option value="CPLJ">CPLJ</option><option value="LVGJ">LVGJ</option><option value="MNTJ">MNTJ</option><option value="MECJ">MECJ</option>
                                                                            <option value="MROJ">MROJ</option><option value="SMPJ">SMPJ</option><option value="STRJ">STRJ</option><option value="DPRJ">DPRJ</option><option value="FNTJ">FNTJ</option><option value="GNRJ">GNRJ</option><option value="ADMJ">ADMJ</option><option value="DPRCDD">DPRCDD</option><option value="LVGCDD">LVGCDD</option><option value="BDRCDD">BDRCDD</option><option value="GNRS">GNRS</option><option value="FORMATION">FORMATION</option><option value="CPLC">CPLC</option><option value="BDRPS">BDRPS</option><option value="CPEF">CPEF</option><option value="FNTLO">FNTLO</option><option value="MNTWT">MNTWT</option> -->

                                                                        <!-- <input type="submit" name="Submit" value="Submit">  -->
                                                                        <!-- <input type="checkbox" name="chkl[ ]" value="Vineet Saini">Vineet Saini<br />  
                                                                        <input type="checkbox" name="chkl[ ]" value="Ravi Sharma">Ravi Sharma<br />  
                                                                        <input type="checkbox" name="chkl[ ]" value="Rahul Dube">Rahul Dube<br />  
                                                                        <input type="checkbox" name="chkl[ ]" value="Rajesh Verma">Rajesh Verma<br />  
                                                                        <input type="checkbox" name="chkl[ ]" value="Priyanka Sachan"> Priyanka Sachan<br />  
                                                                        <br>   -->$query = "SELECT Userid, Name, Duty, Deptid, Plage_E FROM Userinfo WHERE Deptid<>65";*/
                                                                  /*$mat = $_POST['mat'];
                                                                  $name = $_POST['name'];
                                                                  $dates = $_POST['dates'];
                                                                  $entree = $_POST['entree'];
                                                                  $sortie = $_POST['sortie'];*/
                                                                        /*, name, dates, entrees, sorties
                                                                        ?>
                                                      <?php } ?>
                                                      </table> 
                                                      <?php  -->*/
                                                            
                                                                   
                                                                  

                                                            /*odbc_close($con_access);*/
                                                                  /*echo ''.$checkbox1[$i].'';if(){}*/
                                                                  /*$query="SELECT UserId, Name FROM t_dept_user WHERE UserId='$checkbox1[$i]'";
                                                                  $r_query=mysqli_query($connection, $query);
                                                                  while ($ligne = mysqli_fetch_array($r_query)) {
                                                                        echo ' '.$ligne['UserId'].' '.$ligne['Name'].'';
                                                                        echo '</br>';
                                                                  }*/
                                                                  /*$checkbox1[1]=$_POST["mat"];
                                                                  $checkbox1[2]= $_POST['name'];
                                                                  $checkbox1[3]= $_POST['dates'];
                                                                  $checkbox1[4] = $_POST['entree'];
                                                                  $checkbox1[5] = $_POST['sortie'];*/
                                                                  /*$query = "INSERT INTO xtable(name, sex, dates) VALUES('".$checkbox1[$i]."', '".$name."', '".$dates."')";*/
                                                                  /*$query = "INSERT INTO xtable(name, sex, dates) VALUES('".$mat."', '".$name."', '".$dates."')";
                                                                  mysql_query($query) or die(mysql_error());*/

                                                                  /*$query1 = "INSERT INTO xtest(name, sex, h_e) VALUES('".$checkbox1[$i]."', '".$name."', '".$h_entree."')";*/
                                                                  /*$query1 = "INSERT INTO xtest(name, sex, h_e) VALUES('".$mat."', '".$name."', '".$h_entree."')";
                                                                  mysql_query($query1) or die(mysql_error());*/
                                                                  
                                                                  /*$sql="INSERT INTO t_pres_h_e(Userid, Dates, H_E, CheckTime) VALUES('".$checkbox1[$i]."','".$dates."', '".$h_entree."',
                                                                  '".$checktime."')";*/
                                                                  /*$sql="INSERT INTO Checkinout(Userid, CheckTime) VALUES('".$checkbox1[$i]."', '".$checktime."')";
                                                                  $res=odbc_exec($con_access, $sql);*/
                                                                  /*$name = $_POST['name'];
                                                                  for ($i=0; $i < sizeof($checkbox1); $i++) { 
                                                                              echo '' .$checkbox1[$i]. ' ';*/
                                                                              /*echo '</br>';
                                                                        for ($j=$i+1; $j < sizeof($name); $j++) {
                                                                              echo $name[1][$j];
                                                                              echo '</br>';
                                                                        }*/
                                                                  /*}*/
                                                                        /*    echo '<div class="alert alert-success" role="alert">The data is inserted!</div>';*/
                                                                        /*echo ' '.$checkbox1[$i]. ' '.$dates.' '.$entree.' '.$sortie.' ';*/
                                                                        /*$query1 = "INSERT INTO xtest(mat, name, fonction, code, dates, entrees, sorties) 
                                                                        SELECT d.UserId AS mat, u.Name AS name, u.Fonction AS fonction, u.Code AS code, '$dates', '$entrees', '$sorties'
                                                                        FROM t_dept_user d LEFT JOIN t_dept_user u ON u.UserId=d.UserId WHERE d.UserId='$checkbox1[$i]'";
                                                                        mysqli_query($connection, $query1);*/
                                                /*INSERT INTO t_present_jours(UserId, Fonction, Name, DeptId, DeptCode, DeptEff, Dates, Motif)
                                                SELECT UserId, Fonction, Name, DeptId, Code, Effectif, '2021-01-12', 'test' FROM t_dept_user
                                            WHERE UserId='10003' AND DeptId='35'
                                                */
                                               /*$query = "
                                                SELECT UserId, Fonction, Name, DeptId, Code, Effectif, $txtEndDate, $txtObs 
                                                FROM t_dept_user WHERE UserId='$txtUser' AND DeptId='$txtDept'
                                                ";*/
                                            /*$query = INSERT INTO test_night_shift(Dept, Mat, Motif, Dates, Fonction, Name, Code, Effectif)"INSERT INTO test_night_shift(Dept, Mat,Motif, Dates) VALUES('$txtDept', '$txtUser', '$txtObs', '$txtStartDate')";
                                            INSERT INTO test_night_shift(Mat, Fonction, Name, Dept, Code, Effectif, Dates,Motif)<!-- <option value="">Departement</option><option value="23">QA</option><option value="30">ADM</option>
                                                            <option value="31">BDR</option><option value="32">CPE</option><option value="33">CPL</option><option value="34">GNR</option><option value="35">EXP</option><option value="36">LN1</option><option value="37">LVG</option><option value="38">MNT</option>
                                                            <option value="39">MEC</option><option value="40">MRO</option><option value="41">SMP</option><option value="42">STR</option><option value="44">DPR</option><option value="45">FNT</option><option value="46">LN2</option><option value="47">LN3</option><option value="48">LN4</option><option value="49">LN5</option><option value="50">LN6</option><option value="51">LN7</option><option value="52">ZPR</option><option value="53">LN8</option><option value="54">LN9</option>
                                                            <option value="55">LN10</option><option value="56">LN11</option><option value="57">LN12</option>  <option value="58">IE</option>
                                                            <option value="59">LN13</option><option value="60">LN14</option> <option value="61">RLC</option>
                                                            <option value="62">LN15</option><option value="64">RESP</option><option value="66">TRAIN</option>
                                                            <option value="67">LN16</option><option value="68">GNBR</option><option value="69">LN17</option><option value="83">DPRCDD</option>
                                                            <option value="84">LVGCDD</option><option value="85">BDRCDD</option><option value="86">GNRS</option><option value="87">FORMATION</option>
                                                            <option value="88">CPLC</option><option value="89">BDRPS</option><option value="90">CPEF</option><option value="100">FNTLO</option>
                                                            <option value="101">MNTWT</option> -->
                            <!-- <option value="23">QA</option>
                            <option value="30">ADM</option>
                            <option value="31">BDR</option>
                            <option value="32">CPE</option>
                            <option value="33">CPL</option>
                            <option value="34">GNR</option>
                            <option value="35">EXP</option>
                            <option value="36">LN1</option>
                            <option value="37">LVG</option>
                            <option value="38">MNT</option>
                            <option value="39">MEC</option>
                            <option value="40">MRO</option>
                            <option value="41">SMP</option>
                            <option value="42">STR</option>
                            <option value="44">DPR</option>
                            <option value="45">FNT</option>
                            <option value="46">LN2</option>
                            <option value="47">LN3</option>
                            <option value="48">LN4</option>
                            <option value="49">LN5</option>
                            <option value="50">LN6</option>
                            <option value="51">LN7</option>
                            <option value="52">ZPR</option>
                            <option value="53">LN8</option>
                            <option value="54">LN9</option>
                            <option value="55">LN10</option>
                            <option value="56">LN11</option>
                            <option value="57">LN12</option>
                            <option value="58">IE</option>
                            <option value="59">LN13</option>
                            <option value="60">LN14</option>
                            <option value="61">RCL</option>
                            <option value="62">LN15</option>
                            <option value="63">RH</option>
                            <option value="64">RESP</option>
                            <option value="65">STC</option>
                            <option value="66">TRAIN</option>
                            <option value="67">LN16</option>
                            <option value="68">GNBR</option>
                            <option value="69">LN17</option>
                            <option value="70">BDRJ</option>
                            <option value="71">CPEJ</option>
                            <option value="72">CPLJ</option>
                            <option value="73">LVGJ</option>
                            <option value="74">MNTJ</option>
                            <option value="75">MECJ</option>
                            <option value="76">MROJ</option>
                            <option value="77">SMPJ</option>
                            <option value="78">STRJ</option>
                            <option value="79">DPRJ</option>
                            <option value="80">FNTJ</option>
                            <option value="81">GNRJ</option>
                            <option value="82">ADMJ</option>
                            <option value="83">DPRCDD</option>
                            <option value="84">LVGCDD</option>
                            <option value="85">BDRCDD</option>
                            <option value="86">GNRS</option>
                            <option value="87">FORMATION</option>
                            <option value="88">CPLC</option>
                            <option value="89">BDRPS</option>
                            <option value="90">CPEF</option>
                            <option value="100">FNTLO</option>
                            <option value="101">MNTWT</option>
                            <option value="102">FNTCDD</option> -->*/
                                                  

/*                $q_sum = "
                SELECT ROUND(sum(EffJ_1),0) AS T_effJ1, ROUND(sum(EffJ),0) AS T_eff, ROUND(sum(Nb_pres),0) AS T_pres, ROUND(sum(Nb_abs),0) AS T_abs, ROUND((sum(Nb_abs)*100)/(sum(EffJ)),2) AS T_p FROM t_pourcentage_cdd_cdi WHERE (Dates=Date(now()) AND Code!='EXP' AND Code!='GNBR' AND Code!='Total CDI' AND Code!='Total CDD')";
                $q_sum = "SELECT ROUND( SUM( EffJ_1 ) , 0 ) AS T_effJ1, ROUND( SUM( EffJ ) , 0 ) AS T_eff, ROUND( SUM( Nb_pres ) , 0 ) AS T_pres, ROUND( SUM( Nb_abs ) , 0 ) AS T_abs, ROUND( (
SUM( Nb_abs ) *100 ) / ( SUM( EffJ ) ) , 2
) AS T_p, SUM( NS ) , SUM( Com ) , (
SUM( NS ) + SUM( Com )
), (
ROUND( SUM( Nb_abs ) , 0 ) - SUM( NS ) - SUM( Com )
) as abs, (
ROUND( SUM( Nb_pres ) , 0 ) + SUM( NS ) + SUM( Com )
) as pres
FROM t_pourcentage_cdd_cdi
WHERE (
Dates = DATE( NOW( ) ) 
AND Code !=  'EXP'
AND Code !=  'GNBR'
AND Code !=  'Total CDI'
AND Code !=  'Total CDD'
)
";um="SELECT ROUND( SUM( EffJ_1 ) , 0 ) AS T_effJ1, ROUND( SUM( EffJ ) , 0 ) AS T_eff, ROUND( SUM( Nb_pres ) , 0 ) AS T_pres, ROUND( SUM( Nb_abs ) , 0 ) AS T_abs, ROUND( (
// SUM( Nb_abs ) *100 ) / ( SUM( EffJ ) ) , 2
// ) AS T_p, SUM( NS ) , SUM( Com ) , (
// SUM( NS ) + SUM( Com )
// ), (
// ROUND( SUM( Nb_abs ) , 0 ) - SUM( NS ) - SUM( Com )
// ) AS abs, (
// ROUND( SUM( Nb_pres ) , 0 ) + SUM( NS ) + SUM( Com )
// ) AS pres,
// ROUND((((
// ROUND( SUM( Nb_abs ) , 0 ) - SUM( NS ) - SUM( Com )
// )*100)/ROUND( SUM( EffJ ) , 0 )),2) as pourc,
// (
//     ROUND((SUM(SM)*100)/ROUND( SUM( EffJ ) , 0 ),2)
// ) as pourcsm
// FROM t_pourcentage_cdd_cdi
// WHERE (
// Dates = DATE( NOW( ) ) 
// AND Code !=  'EXP'
// AND Code !=  'GNBR'
// AND Code !=  'Total CDI'
// AND Code !=  'Total CDD'
// )


/*PREMIER TEST REQUETE*/
/* $q_sum = "SELECT ROUND(SUM(EffJ_1),0) AS T_effJ1, ROUND(SUM(EffJ), 0 ) AS T_eff, ROUND( SUM( Nb_pres ) , 0 ) AS T_pres, ROUND( SUM( Nb_abs ) , 0 ) AS T_abs, ROUND((SUM(Nb_abs)*100) /( SUM( EffJ ) ) , 2 ) AS T_p, SUM( NS ) , SUM( Com ) , ( SUM( NS ) + SUM( Com ) ), ( ROUND( SUM( Nb_abs ) , 0 ) - SUM( NS ) - SUM( Com ) ) AS abs, ( ROUND( SUM( Nb_pres ) , 0 ) + SUM( NS ) + SUM( Com ) ) AS pres, ROUND(((( ROUND( SUM( Nb_abs ) , 0 ) - SUM( NS ) - SUM( Com ) )*100)/ROUND( SUM( EffJ ) , 0 )),2) as pourc, ( ROUND((SUM(SM)*100)/ROUND( SUM( EffJ ) , 0 ),2) ) as pourcsm FROM t_pourcentage_cdd_cdi WHERE (Dates = DATE(NOW()) AND Code != 'EXP' AND Code != 'GNBR' AND Code != 'Total CDI' AND Code != 'Total CDD' )";*/
/*FIN PREMIER TEST REQUETE*/
/*                $q_sum="
SELECT ROUND(SUM(EffJ_1),0) AS T_effJ1, ROUND(SUM(EffJ),0) AS T_eff, ROUND(SUM(Nb_pres),0) AS T_pres, ROUND(SUM(Nb_abs),0) AS T_abs, ROUND((SUM(Nb_abs)*100)/(SUM(EffJ)),2) AS T_p, 
SUM(NS) , SUM(Com) , 
(CASE 
    WHEN SUM(NS) IS NULL THEN SUM(Com) 
    WHEN SUM(Com) IS NULL THEN SUM(NS)
ELSE (SUM(Com)+SUM(NS)) END), 
(CASE
    WHEN SUM(NS) IS NULL THEN (ROUND(SUM(Nb_abs),0)-SUM(Com))
    WHEN SUM(Com) IS NULL THEN (ROUND(SUM(Nb_abs),0)-SUM(NS))
    WHEN (SUM(NS) IS NULL AND SUM(Com) IS NULL) THEN ROUND(SUM(Nb_abs),0)
    ELSE (ROUND(SUM(Nb_abs),0)-SUM(NS)-SUM(Com))
END) AS abs, 
(CASE 
    WHEN SUM(NS) IS NULL THEN (ROUND(SUM(Nb_pres),0)+SUM(Com))
    WHEN SUM(Com) IS NULL THEN (ROUND(SUM(Nb_pres),0)+SUM(NS))
    WHEN (SUM(NS) IS NULL AND SUM(Com) IS NULL) THEN ROUND(SUM(Nb_pres),0) 
    ELSE (ROUND(SUM(Nb_pres),0)+SUM(NS)+SUM(Com))
END) AS pres,
(CASE
    WHEN SUM(NS) IS NULL THEN ROUND((((ROUND(SUM(Nb_abs),0)-SUM(Com))*100)/ROUND(SUM(EffJ),0)),2)
    WHEN SUM(Com) IS NULL THEN ROUND((((ROUND(SUM(Nb_abs),0)-SUM(NS))*100)/ROUND(SUM(EffJ),0)),2) 
    WHEN (SUM(NS) IS NULL AND SUM(Com) IS NULL) THEN ROUND((((ROUND(SUM(Nb_abs),0))*100)/ROUND(SUM(EffJ),0)),2) 
    ELSE ROUND((((ROUND(SUM(Nb_abs),0)-SUM(NS)-SUM(Com))*100)/ROUND(SUM(EffJ),0)),2) 
END) as pourc, (ROUND((SUM(SM)*100)/ROUND(SUM(EffJ),0),2)) as pourcsm 
FROM t_pourcentage_cdd_cdi 
WHERE (Dates = DATE(NOW()) AND Code != 'EXP' AND Code != 'GNBR' AND Code != 'Total CDI' AND Code != 'Total CDD' )";*/

               
                /*$q_sum = "SELECT ROUND(SUM(EffJ_1),0) AS T_effJ1, ROUND(SUM(EffJ),0) AS T_eff, SUM(NS) , SUM(Com) ,(ROUND(SUM(Nb_pres),0)+SUM(NS)+SUM(Com)) AS T_pres, 
                (ROUND(SUM(Nb_abs),0)-SUM(NS)-SUM(Com)) AS T_abs, 
                ROUND((SUM(Nb_abs)*100) /(SUM(EffJ)),2) AS T_p,  (SUM(NS)+SUM(Com)), 
                (ROUND(SUM(Nb_abs),0)-SUM(NS)-SUM(Com)) AS abs, (ROUND(SUM(Nb_pres),0)+SUM(NS)+SUM(Com)) AS pres, 
                ROUND(((( ROUND(SUM( Nb_abs),0)-SUM(NS)-SUM( Com ) )*100)/ROUND( SUM( EffJ ) , 0 )),2) as pourc, 
                (ROUND((SUM(SM)*100)/ROUND( SUM( EffJ ) , 0 ),2) ) as pourcsm 
                FROM t_pourcentage_absence 
                WHERE (Dates = DATE(NOW()) AND Code != 'EXP' AND Code != 'GNBR' AND Code != 'Total CDI' AND Code != 'Total CDD' )";*/

SELECT DISTINCT (Checkinout.Userid) AS UserId, Userinfo.Name AS Name, Userinfo.Duty AS Fonction, Userinfo.Deptid AS DeptId, t_dept_save.Code AS DeptCode, t_dept_save.Effectif AS DeptEff, DateValue(Checkinout.CheckTime) AS Dates
FROM Checkinout, Userinfo, t_dept_save
WHERE (
      ( (Userinfo.Deptid)=[t_dept_save].[DeptId]) 
AND ((t_dept_save.Code)<>'BDRJ' 
      And (t_dept_save.Code)<>'CPEJ' 
      And (t_dept_save.Code)<>'CPLJ' 
      And (t_dept_save.Code)<>'LVGJ' 
      And (t_dept_save.Code)<>'MNTJ' 
      And (t_dept_save.Code)<>'MECJ' 
      And (t_dept_save.Code)<>'MROJ' 
      And (t_dept_save.Code)<>'SMPJ' 
      And (t_dept_save.Code)<>'STRJ' 
      And (t_dept_save.Code)<>'DPRJ' 
      And (t_dept_save.Code)<>'FNTJ' 
      And (t_dept_save.Code)<>'GNRJ' 
      And (t_dept_save.Code)<>'ADMJ' 
      And (t_dept_save.Code)<>'STC') 
AND ((Checkinout.Userid)=[Userinfo].[Userid]) 
AND (TimeValue(Checkinout.CheckTime)>'05:30:00') 
AND ((DateValue([Checkinout].[CheckTime]))=Date()-1));

SELECT Checkinout.Userid AS UserId, Min(Userinfo.Name) AS Name, Min(Userinfo.Duty) AS Fonction, Min(Userinfo.Deptid) AS DeptId, Min(t_dept_save.Code) AS Code, Min(t_dept_save.Effectif) AS Effectif, DateValue(Checkinout.CheckTime) AS Dates, TimeValue(Min(Checkinout.CheckTime)) AS H_entree, TimeValue(Max(Checkinout.CheckTime)) AS H_sortie, (Format((TimeValue(Max(Checkinout.CheckTime))-TimeValue(Min(Checkinout.CheckTime))),"hh:nn:ss")) AS H_travail
FROM Checkinout, Userinfo, t_dept_save
WHERE (((Checkinout.Userid)=[Userinfo].[Userid]) AND ((Userinfo.Deptid)=[t_dept_save].[DeptId]) AND ((DateValue([Checkinout].[CheckTime]))=Date()-1))
GROUP BY Checkinout.Userid, DateValue(Checkinout.CheckTime);


SELECT Checkinout.Userid AS UserId, Min(Userinfo.Name) AS Name, Min(Userinfo.Duty) AS Fonction, Min(Userinfo.Deptid) AS DeptId, Min(t_dept_save.Code) AS Code, Min(t_dept_save.Effectif) AS Effectif, DateValue(Checkinout.CheckTime) AS Dates, TimeValue(Min(Checkinout.CheckTime)) AS H_entree, TimeValue(Max(Checkinout.CheckTime)) AS H_sortie, (Format((TimeValue(Max(Checkinout.CheckTime))-TimeValue(Min(Checkinout.CheckTime))),"hh:nn:ss")) AS H_travail
FROM Checkinout, Userinfo, t_dept_save
WHERE (((Checkinout.Userid)=[Userinfo].[Userid]) AND ((Userinfo.Deptid)=[t_dept_save].[DeptId]) AND ((DateValue([Checkinout].[CheckTime])) BETWEEN Date()-1 AND Date()) AND (TimeValue(Min(Checkinout.CheckTime))<'05:30:00'))
GROUP BY Checkinout.Userid, DateValue(Checkinout.CheckTime);

INSERT INTO t_night_shift_entree ( UserId, Name, Fonction, DeptId, Code, Effectif, Dates, H_entree )
SELECT Userinfo.Userid AS UserId, Userinfo.Name, 
Userinfo.Duty AS Fonction, 
Userinfo.Deptid AS DeptId, 
t_dept_save.Code AS Code, 
t_dept_save.Effectif AS Effectif, 
DateValue(Checkinout.CheckTime) AS Dates, 
TimeValue(Checkinout.CheckTime) AS H_entree
FROM Userinfo, t_dept_save, Checkinout
WHERE (((Userinfo.Deptid)=[t_dept_save].[DeptId]) AND ((t_dept_save.Code)<>'STC') 
      AND ((Checkinout.Userid)=[Userinfo].[Userid]) 
      AND ((DateValue([Checkinout].[CheckTime]))=[Formulaires]![DATA JOURS]![txt_date_1]) 
      AND ((TimeValue([Checkinout].[CheckTime])) Between "17:15:00" And "23:59:59"));

SELECT n.UserId, n.Name, n.Fonction, n.H_entree, m.Obs, m.Dates FROM t_night_shift_entree n
LEFT JOIN t_night_shift_sortie s ON s.UserId=n.UserId AND s.Dates=''
LEFT JOIN t_motif m ON n.UserId=m.UserId AND n.Dates=m.Dates 
WHERE m.Dates='2021-02-08' AND m.Obs='night shift'

SELECT * FROM `t_motif` WHERE Dates='2021-02-08' AND Obs='night shift'

SELECT * FROM `t_night_shift_sortie` WHERE Dates='2021-02-09'

/*night shift*/
INSERT INTO t_h_nuit(UserId, Name, Fonction, DeptId, Code, Dates, H_entree, H_sortie)
SELECT e.UserId AS UserId, e.Name AS Name, e.Fonction AS Fonction,e.DeptId AS DeptId,e.Code AS DeptId, e.Dates AS Dates, e.H_entree AS H_entree, s.H_sortie AS H_sortie
FROM t_night_shift_entree e LEFT JOIN t_night_shift_sortie s ON e.UserId = s.UserId WHERE e.Dates =date_add(curdate(), interval -1 day) AND s.Dates=DATE(NOW())

SELECT m.UserId, m.Name, m.Fonction, m.DeptId, m.Code, m.Obs, m.Dates, e.H_entree, s.H_sortie
FROM t_motif m
LEFT JOIN t_night_shift_entree e ON e.UserId=m.UserId AND e.Dates=date_add(curdate(), interval -1 day)
LEFT JOIN t_night_shift_sortie s ON s.UserId=m.UserId AND s.Dates=DATE(NOW())
WHERE m.Dates=date_add(curdate(), interval -1 day) AND m.Obs='night shift'
 
SELECT m.UserId, m.Name, m.Fonction, m.DeptId, m.Code, m.Obs, m.Dates, e.H_entree, s.H_sortie
FROM t_motif m
LEFT JOIN t_night_shift_entree e ON e.UserId=m.UserId AND e.Dates='2021-02-08'
LEFT JOIN t_night_shift_sortie s ON s.UserId=m.UserId AND s.Dates='2021-02-09'
WHERE m.Dates='2021-02-08' AND m.Obs='night shift'


UPDATE t_h_nuit SET Pause='00:00:00' WHERE Dates=date_add(curdate(), interval -1 day)
UPDATE t_h_nuit SET P_entree='22:00:00' WHERE Dates=date_add(curdate(), interval -1 day)
/*end night shift*/

SELECT m.UserId, m.Name, m.Fonction, m.DeptId, m.Code, m.Obs, m.Dates, e.H_entree, s.H_sortie
FROM t_motif m
LEFT JOIN t_night_shift_entree e ON e.UserId=m.UserId AND e.Dates='2021-02-08'
LEFT JOIN t_night_shift_sortie s ON s.UserId=m.UserId AND s.Dates='2021-02-09'
WHERE m.Dates='2021-02-08' AND m.Obs='night shift'


/*test requete access*/
SELECT DISTINCT (Checkinout.Userid) AS UserId, Userinfo.Name AS Name, Userinfo.Duty AS Fonction, Userinfo.Deptid AS DeptId, t_dept_save.Code AS DeptCode, t_dept_save.Effectif AS DeptEff, DateValue(Checkinout.CheckTime) AS Dates
FROM Checkinout, Userinfo, t_dept_save
WHERE (((Userinfo.Deptid)=[t_dept_save].[DeptId]) AND ((t_dept_save.Code)<>'BDRJ' And (t_dept_save.Code)<>'CPEJ' And (t_dept_save.Code)<>'CPLJ' And (t_dept_save.Code)<>'LVGJ' And (t_dept_save.Code)<>'MNTJ' And (t_dept_save.Code)<>'MECJ' And (t_dept_save.Code)<>'MROJ' And (t_dept_save.Code)<>'SMPJ' And (t_dept_save.Code)<>'STRJ' And (t_dept_save.Code)<>'DPRJ' And (t_dept_save.Code)<>'FNTJ' And (t_dept_save.Code)<>'GNRJ' And (t_dept_save.Code)<>'ADMJ' And (t_dept_save.Code)<>'STC') AND ((Checkinout.Userid)=[Userinfo].[Userid]) AND ((TimeValue(Checkinout.CheckTime))>'05:30:00') AND ((DateValue([Checkinout].[CheckTime]))=Date()-2));



SELECT Userinfo.Userid AS UserId, Userinfo.Name, Userinfo.Duty AS Fonction, Userinfo.Deptid AS DeptId, t_dept_save.Code AS Code, t_dept_save.Effectif AS Effectif, DateValue(Checkinout.CheckTime) AS Dates, TimeValue(Checkinout.CheckTime) AS H_sortie
FROM Userinfo, t_dept_save, Checkinout
WHERE (((Userinfo.Deptid)=[t_dept_save].[DeptId]) AND ((t_dept_save.Code)<>'STC') AND ((Checkinout.Userid)=[Userinfo].[Userid]) AND ((DateValue([Checkinout].[CheckTime]))=Date()-1) AND ((TimeValue([Checkinout].[CheckTime])) Between "05:30:00" And "12:30:00"));

SELECT Checkinout.Userid AS UserId, Min(Userinfo.Name) AS Name, Min(Userinfo.Duty) AS Fonction, Min(Userinfo.Deptid) AS DeptId, Min(t_dept_save.Code) AS Code, Min(t_dept_save.Effectif) AS Effectif, DateValue(Checkinout.CheckTime) AS Dates, TimeValue(Min(Checkinout.CheckTime)) AS H_entree, TimeValue(Max(Checkinout.CheckTime)) AS H_sortie, (Format((TimeValue(Max(Checkinout.CheckTime))-TimeValue(Min(Checkinout.CheckTime))),"hh:nn:ss")) AS H_travail
FROM Checkinout, Userinfo, t_dept_save
WHERE (((Checkinout.Userid)=[Userinfo].[Userid]) AND ((Userinfo.Deptid)=[t_dept_save].[DeptId]) AND ((DateValue([Checkinout].[CheckTime]))=#01/13/21#))
GROUP BY Checkinout.Userid, DateValue(Checkinout.CheckTime);
/*end test requete access*/

/*Mety*/
SELECT Userinfo.Userid AS UserId, Userinfo.Name, Userinfo.Duty AS Fonction, Userinfo.Deptid AS DeptId, t_dept_save.Code AS Code, t_dept_save.Effectif AS Effectif, DateValue(Checkinout.CheckTime) AS Dates
FROM Userinfo, t_dept_save, Checkinout
WHERE (((Userinfo.Deptid)=[t_dept_save].[DeptId]) AND ((t_dept_save.Code)<>'BDRJ' And (t_dept_save.Code)<>'CPEJ' And (t_dept_save.Code)<>'CPLJ' And (t_dept_save.Code)<>'LVGJ' And (t_dept_save.Code)<>'MNTJ' And (t_dept_save.Code)<>'MECJ' And (t_dept_save.Code)<>'MROJ' And (t_dept_save.Code)<>'SMPJ' And (t_dept_save.Code)<>'STRJ' And (t_dept_save.Code)<>'DPRJ' And (t_dept_save.Code)<>'FNTJ' And (t_dept_save.Code)<>'GNRJ' And (t_dept_save.Code)<>'ADMJ' And (t_dept_save.Code)<>'STC') AND ((Checkinout.Userid)=[Userinfo].[Userid]) AND ((DateValue([Checkinout].[CheckTime]))=Date()-1) AND ((TimeValue([Checkinout].[CheckTime])) Between "05:30:00" And "12:30:00"));
/*Fin mety*/

SELECT DISTINCT (Checkinout.Userid) AS UserId, Userinfo.Name AS Name, Userinfo.Duty AS Fonction, Userinfo.Deptid AS DeptId, t_dept_save.Code AS DeptCode, t_dept_save.Effectif AS DeptEff, DateValue(Checkinout.CheckTime) AS Dates
FROM Checkinout, Userinfo, t_dept_save
WHERE (((Userinfo.Deptid)=t_dept_save.DeptId) And ((t_dept_save.Code)<>'BDRJ' And (t_dept_save.Code)<>'CPEJ' And (t_dept_save.Code)<>'CPLJ' And (t_dept_save.Code)<>'LVGJ' And (t_dept_save.Code)<>'MNTJ' And (t_dept_save.Code)<>'MECJ' And (t_dept_save.Code)<>'MROJ' And (t_dept_save.Code)<>'SMPJ' And (t_dept_save.Code)<>'STRJ' And (t_dept_save.Code)<>'DPRJ' And (t_dept_save.Code)<>'FNTJ' And (t_dept_save.Code)<>'GNRJ' And (t_dept_save.Code)<>'ADMJ' And (t_dept_save.Code)<>'STC') And Checkinout.UserId='26528' And ((Checkinout.Userid)=Userinfo.Userid) And ((DateValue(Checkinout.CheckTime))=Date()));

SELECT Checkinout.Userid AS UserId, Userinfo.Name AS Name, Userinfo.Duty AS Fonction, Userinfo.Deptid AS DeptId, t_dept_save.Code AS DeptCode, t_dept_save.Effectif AS DeptEff, DateValue(Checkinout.CheckTime) AS Dates
FROM Checkinout, Userinfo, t_dept_save
WHERE (((Userinfo.Deptid)=t_dept_save.DeptId) 
      And ((t_dept_save.Code)<>'BDRJ' 
            And (t_dept_save.Code)<>'CPEJ' 
            And (t_dept_save.Code)<>'CPLJ' 
            And (t_dept_save.Code)<>'LVGJ' 
            And (t_dept_save.Code)<>'MNTJ' 
            And (t_dept_save.Code)<>'MECJ' 
            And (t_dept_save.Code)<>'MROJ' 
            And (t_dept_save.Code)<>'SMPJ' 
            And (t_dept_save.Code)<>'STRJ' 
            And (t_dept_save.Code)<>'DPRJ' 
            And (t_dept_save.Code)<>'FNTJ' 
            And (t_dept_save.Code)<>'GNRJ' 
            And (t_dept_save.Code)<>'ADMJ' 
            And (t_dept_save.Code)<>'STC') 
      And Checkinout.UserId='26528' 
      And ((Checkinout.Userid)=Userinfo.Userid) 
      And ((DateValue(Checkinout.CheckTime))=Date()))
;


SELECT Checkinout.Userid AS UserId, Min(Userinfo.Name) AS Name, Min(Userinfo.Duty) AS Fonction, Min(Userinfo.Deptid) AS DeptId, Min(t_dept_save.Code) AS DeptCode, 
Min(t_dept_save.Effectif) AS DeptEff, (DateValue(Min(Checkinout.CheckTime))) AS Dates, (COUNT(Checkinout.Userid)) AS Nb
FROM Checkinout, Userinfo, t_dept_save
WHERE (((Userinfo.Deptid)=t_dept_save.DeptId) 
      And ((t_dept_save.Code)<>'BDRJ' 
            And (t_dept_save.Code)<>'CPEJ' 
            And (t_dept_save.Code)<>'CPLJ' 
            And (t_dept_save.Code)<>'LVGJ' 
            And (t_dept_save.Code)<>'MNTJ' 
            And (t_dept_save.Code)<>'MECJ' 
            And (t_dept_save.Code)<>'MROJ' 
            And (t_dept_save.Code)<>'SMPJ' 
            And (t_dept_save.Code)<>'STRJ' 
            And (t_dept_save.Code)<>'DPRJ' 
            And (t_dept_save.Code)<>'FNTJ' 
            And (t_dept_save.Code)<>'GNRJ' 
            And (t_dept_save.Code)<>'ADMJ' 
            And (t_dept_save.Code)<>'STC')  
      And ((Checkinout.Userid)=Userinfo.Userid)
      And ((DateValue(Checkinout.CheckTime))=Date()))
GROUP BY Checkinout.Userid
;

